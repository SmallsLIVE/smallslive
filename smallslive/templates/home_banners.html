{% load full_static %}

<div class="banners">
  <div id="banner-container">
    {% fullstatic 'image/banners/archive.jpg' as banner_picture_url %}
    <div class="lighten-image banner-background">
      {% include 'partials/thumbored_picture.html' with local_url='image/banners/archive.jpg' %}
    </div>
    <div class="banner-border flex-row">
      <div class="banner-title-button flex-column">
        <div id="banner-title">Archive</div>
        <div class="banner-learnmore">
          <button id="banner-button"></button>
        </div>
      </div>
      <div class="banner-text-container flex-row items-center">
        <p id="banner-text">El texto</p>
      </div>
      <div>
        <a href="#" class="close-button"></a>
      </div>
    </div>
  </div>
  {% if not active %}
  <div id="banner-options" class="banner-options flex-row">
    <div id="banner-archive-box" class="banner-option">
      {% fullstatic 'image/banners/archive.jpg' as banner_picture_url %}
      <div class="fake-image archive">
        {% include 'partials/thumbored_picture.html' with local_url='image/banners/archive.jpg' %}
      </div>
    </div>
    <div id="banner-live-box" class="banner-option shadow-text">
      {% fullstatic 'image/banners/live.jpg' as banner_picture_url %}
      <div class="fake-image live">
        {% include 'partials/thumbored_picture.html' with local_url='image/banners/live.jpg' %}
      </div>
    </div>
    <div id="banner-mission-box" class="banner-option">
      {% fullstatic 'image/banners/mission.jpg' as banner_picture_url %}
      <div class="fake-image mission">
        {% include 'partials/thumbored_picture.html' with local_url='image/banners/mission.jpg' %}
      </div>
    </div>
  </div>
  {% endif %}
</div>
<script>
  $(document).ready(function(){

    var showBecomeMemberModal = function() {
      var becomeMember = $('#becomeMemberButton');
      becomeMember.click();
    };

    var bannerText = {
      archive: {
        text: '<span class="accent-color">Every show</span> at smalls + mezzrow has been recorded and archived since 2007. Supporting members enjoy <span class="accent-color">unlimited access</span> to our archive. Our musicians are paid royalties through our unique <span class="accent-color">revenue share system.</span>',
        button: 'Learn More',
        click: function() {
          window.location = '{% url 'archive' %}';
        }
      },
      'live stream': {
        text: 'Our <span class="accent-color">live stream</span> has expanded our 60 seat clubs into a worlwide community of jazz fans and supporters. <span class="accent-color">Sign up for free</span> to watch our live stram every night.',
        button: 'Become a member',
        click: showBecomeMemberModal

      },
      mission: {
        text: 'the <span class="accent-color">smallslive foundation</span> is a <span class="accent-color">not-for-profit</span> organized for the purpose of the <span class="accent-color">dissemination of jazz music</span> through our archive, live streams, sponsorship of individual jall projects & tours, education, and live performances at smalls & mezzrow. we are supported by our members through <span class="accent-color">tax-deductible donations</span>.',
        button: 'Become a member',
        click: showBecomeMemberModal
      },
      supporter: {
        text: 'Your supporting pledge goes <span class="accent-color">directly to your favourite artists</span> & helps make smallsville possible through our <span class="accent-color">smallslive revenue share</span>. Supporting members have unlimited access to our archive of <span class="accent-color">every concert</span> performed at smalls + mezzrow',
        button: 'Become a supporter',
        title: 'Why become a supporter?',
        click: function() {
          window.location = '{% url 'become_supporter' %}';
        }
      }
    };

    var bannerContainer = $('#banner-container');
    var bannerOptions = $('#banner-options');
    $('#banner-archive-box').on('click', function () {
      setContainerBanner('archive');
    });

    $('#banner-live-box').on('click', function () {
      setContainerBanner('live stream');
    });

    $('#banner-mission-box').on('click', function () {
      setContainerBanner('mission');
    });

    bannerContainer.find('a.close-button').on('click', function () {
      bannerOptions.show();
      bannerContainer.hide();
    });

    function setContainerBanner(src) {
      bannerImage = bannerContainer.find('.banner-background').find('img')[0]
      $(bannerImage).attr('src','static/image/banners/'+ src +'_text.jpg')
      
      var banner = bannerText[src];
      bannerContainer.find('#banner-text').html(banner.text);
      var find = bannerContainer.find('#banner-title');
      if (banner.title) {
        find.text(banner.title);
        find.addClass('custom-banner-text');
      } else {
        find.text(src);
        find.removeClass('custom-banner-text');
      }
      var bannerButton = bannerContainer.find('#banner-button');
      bannerButton.text(banner.button);
      bannerButton.off('click');
      bannerButton.on('click', function ($event) {
        $event.stopPropagation();
        banner.click();
      });

      bannerContainer.show();
      bannerOptions.hide();
    }

    {% if active %}
      setContainerBanner('{{ active }}');
    {% else %}
      bannerContainer.find('a.close').on('click', function () {
        bannerOptions.show();
        bannerContainer.hide();
      });
    {% endif %}
  });
</script>
