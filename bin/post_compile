#!/usr/bin/env bash

# Installed these packages after all packages specially setuptools 45.x installed
pip install celery==3.1.19 django-celery==3.3.1 dj-stripe==1.1.0 django-ajax==0.3.0 django-cacheops==5.0.1 django-celery==3.3.1 django-haystack==2.8.1 django-js-asset==2.0.0 django-model-utils==4.1.1 django-phonenumber-field==2.0.1 django-polymorphic==3.1.0 django-polymorphic==3.1.0 django-thumbor==0.5.3 djrill==2.1.0 jsonfield==2.0.2
pip install smallslive-metrics-app@git+https://github.com/SmallsLIVE/smallslive-metrics-djangoapp.git@e5b4b537a4356ea4e2ba1e9a20409d33c8fef544
pip install django==2.2.8
pip install djangorestframework==3.13.0
pip install django-filter==2.3.0
pip install celery==3.1.19

# Run Django migrations.
python smallslive/manage.py migrate catalogue --noinput
python smallslive/manage.py migrate voucher --noinput

# Sync djstripe data
python smallslive/manage.py resync_subscriptions
python smallslive/manage.py sync_customers